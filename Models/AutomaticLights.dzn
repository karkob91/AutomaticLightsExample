interface ILightShifter {
    in void Toogle();

    behavior {
        on Toogle: {}
    }

}

interface IHighBeamsRelay {
    in bool TurnOn();
    in bool TurnOff();
    

    behavior {
        bool isTurnedOn = false;

        [isTurnedOn] {
            
            on TurnOff: {
                isTurnedOn = false;
            }
        }
        [!isTurnedOn] {
            on TurnOn: {
                isTurnedOn = true;
            }
            
        }
    }

}

interface ILightSensor {
    out void LowLight();
    out void HighLight();
    enum State {Low, High};

    behavior {
        State state = State.High;
        [state.High] {
            on inevitable: {
                state = State.Low;
                LowLight;
            }
        }
        [state.Low] {
            on inevitable: {
                state = State.High;
                HighLight;
            }
        }
    }
}



component ModeSelector {
    provides ILightShifter lightShifter;
    requires IHighBeamsRelay beamsRelay;
    requires ILightSensor lightSensor;

    behavior {

        void ToggleLights() {
            if(beamsRelay.isTurnedOn)
                beamsRelay.TurnOff();
            else {
                beamsRelay.TurnOn();
            }
        }
        [beamsRelay.isTurnedOn] {
            on lightShifter.Toogle(): {
                beamsRelay.TurnOff();
            }
            on lightSensor.HighLight(): {
                beamsRelay.TurnOff();
            }
            on lightSensor.LowLight(): {}
        }
        [!beamsRelay.isTurnedOn] {
            on lightShifter.Toogle(), lightSensor.LowLight(): {
                beamsRelay.TurnOn();
            }
            on lightSensor.HighLight(): {}
            

        }

        
    }

}